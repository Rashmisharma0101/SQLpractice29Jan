STEP 1 â€” Revenue trend (core metric)
SELECT
  DATE(order_date) AS dt,
  SUM(quantity * price) AS daily_revenue
FROM orders
GROUP BY DATE(order_date)
ORDER BY dt;


ğŸ“Œ Insight to write:

Is revenue growing?

Spikes or drops?

STEP 2 â€” Top products (80/20 rule)
SELECT
  product_id,
  SUM(quantity * price) AS revenue
FROM orders
GROUP BY product_id
ORDER BY revenue DESC;


ğŸ“Œ Insight:

Which 20% products generate most revenue?

STEP 3 â€” Customer concentration risk
SELECT
  customer_id,
  SUM(quantity * price) AS revenue
FROM orders
GROUP BY customer_id
ORDER BY revenue DESC;


ğŸ“Œ Insight:

Are we dependent on few customers?

STEP 4 â€” Repeat customers
SELECT customer_id, COUNT(*) AS orders
FROM orders
GROUP BY customer_id
HAVING COUNT(*) > 1;


ğŸ“Œ Insight:

How many loyal customers do we have?

STEP 5 â€” Low performing products
SELECT product_id, SUM(quantity * price) AS revenue
FROM orders
GROUP BY product_id
ORDER BY revenue ASC;


ğŸ“Œ Insight:

Which products should be improved or removed?
-------------------------------------------------------------------------
repeat rate% of cstomers

with cte1 as (select customer_id, count(order_id) as cnt from orders group by customer_id),
cte2 as (select customer_id, case when cnt > 1 then 1 else 0 end as tag from cte1)
select avg(tag) as repeat_percentage from cte2

